# Introductory concepts of how malware is detected

### Static/Signature Detection

A signature is a string of data that uniquely identifies a malware. Take for instance Msfvenom's x64 exec payload. The shellcode generated by Msfvenom will begin with `FC 48 83 E4 F0 E8 C0 00 00 00 41 51 41 50 52 51`. A tool such as [YARA](https://virustotal.github.io/yara/) will have a database of strings that are recognized as malicious and will flag any program that has a string that matches.

Bypassing signature detection is easy, but time-consuming. Hardcoding values that can be identified by tools like YARA in your malware should be avoided. 

#### Hashing Detection

Hashing detection is a subset of signature detection. It is almost identical to signature except in this method hashes (MD5, SHA256, etc.) are compared rather than strings of hex values or code. It is extremely easy to avoid this type of detection, as changing even just one byte in a program can completely change its hash value.    

#### Heuristic Detection

Heuristic detection focuses on identifying suspicious characteristics that can be present in malware that is unknown, new, or is modified from existing malware. Heuristic models can be one or both of the following:

**Static Heuristic Analysis -** In static analysis, the malware is decompiled and the source code is compared to the source code of viruses that have already been logged in a database. If too many code snippets match what's in the database, then the malware is flagged. 

**Dynamic Heuristic Analysis -** Dynamic analysis involves the use of sandbox in which the virus is compiled/executed. From there, the virus is analyzed and monitored for any suspicious behavior.

#### Behavior-based Detection

Behavior-based analyzes malware on run-time and monitors the behavior. If a security solution notices any suspicious behavior such as, "loading a DLL, calling a certain Windows API and connecting to the internet." (maldevacademy, n.d), then the file will be flagged as a malicious program. 

#### API Hooking

API hooking is an effective technique used by security solutions that involves the interception of API calls from the malicious program. The API calls are then analyzed for any suspicious behaviors. This detection mechanism is a combination of real-time and behavior-based. This diagram shows a high level of API hooking:

![[Pasted image 20231007020357.png]]

#### IAT Checking

The Import Address Table (IAT) contains the addresses of the DLL functions that are used in the portable executable (PE) at runtime. A security solution may check the IAT for any suspicious function calls. 

#### Manual Analysis

Even if your malware bypasses all the detection mechanisms listed above, a malware analyst can still manually look over the malware. Someone who is well versed in reverse engineering malware can identify and report copies of suspicious files. 